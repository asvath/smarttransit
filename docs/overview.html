<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>TTC Delay Insights — Overview</title>
  <style>
    :root{
      --red:#dc2626; --border:#313131; --muted:#9ca3af; --bg:#0b0b0c; --green:#a3e635;
      --btn:#16171a; --btn-border:#2a2a2f; --btn-hover:#1e2024; --btn-active:#262a30; --focus:#a7b0ff;
    }
    *{ box-sizing:border-box }
    body{ margin:0; font-family: Inter, system-ui, Segoe UI, Arial; background:var(--bg); color:#f5f5f6; font-size:18px; line-height:1.55; }

    header{ position:sticky; top:0; z-index:10; background:#0f0f11; border-bottom:1px solid var(--border); }
    .container{ max-width:1360px; margin:0 auto; padding:18px 22px; }
    .brand{ display:flex; align-items:center; gap:12px; }
    .badge{ width:44px; height:44px; border-radius:12px; background:var(--red); color:#fff; display:grid; place-items:center; font-weight:700; font-size:18px; }
    .muted{ color:var(--muted); }

    .nav{ display:flex; gap:12px; flex-wrap:wrap; margin-top:8px; }
    .btn{ border:1px solid var(--border); background:#121214; color:#f5f5f6; padding:16px 22px; border-radius:12px; cursor:pointer; font-weight:700; font-size:18px; text-decoration:none; display:inline-block; }
    .btn.primary{ background:var(--red); color:#fff; border-color:var(--red); }

    /* Main layout  */
    main{ max-width:1360px; margin:20px auto; padding:0 22px; }
    section.aligned{ display:flex; flex-direction:column; gap:22px; }

    /* Card + content  */
    .card{ background:#121214; border:1px solid var(--border); border-radius:16px; box-shadow:0 1px 3px rgba(0,0,0,.35); width:100%; }
    .content{ padding:28px; }

    /* Typography  */
    .section-title{ font-weight:700; font-size:26px; margin-bottom:10px; }
    .section-sub{ color:#d1d5db; margin-bottom:16px; font-size:18px; line-height:1.7; }

    a{ color:var(--green); text-decoration:none; font-weight:600; }

    footer{ padding:28px 22px; text-align:center; color:#9ca3af; }
    footer a{ font-weight:inherit !important; color:inherit !important; text-decoration:none !important; }

    /* Overview-specific helpers (kept minimal so look stays identical) */
    .intro h2{ margin:0 0 8px; font-size:26px; font-weight:700; color:#fff; }
    .intro p.lead{ margin:6px 0 0; font-size:20px; line-height:1.7; color:#e8eaee; }
    /* Responsive Plotly charts */
    .chartframe{
      width:100%;
      min-height:320px;
      height:560px;            /* desktop */
      border:none;
      border-radius:12px;
      background:#0f1012;
    }
    @media (max-width:860px){
      .chartframe{
        height:70vh;           /* mobile: use most of the screen */
        min-height:280px;      /* prevent squish */
      }
    }
    /* For smaller phones */
    @media (max-width:500px){
      .chartframe{
        height:65vh;
      }
    }


    .tip{ margin:12px 0 0; border:1px dashed #2a2a2a; border-radius:12px; background:#0f1012; padding:12px 14px; font-size:16.5px; color:#d8dbe2; }

    @media (max-width:1020px){
      .content{ padding:18px; }
      .intro h2{ font-size:20px; }
      .intro p.lead{ font-size:16px; }
    }

    /* ===== Mobile hamburger same as index.html ===== */
    .hamburger{
      display:none; width:42px; height:42px; border:1px solid var(--border);
      background:#121214; border-radius:10px; align-items:center; justify-content:center;
      gap:5px; flex-direction:column; cursor:pointer;
    }
    .hamburger span{ width:22px; height:2px; background:#e8eaee; display:block; transition:transform .2s ease, opacity .2s ease; }
    .hamburger.is-open span:nth-child(1){ transform:translateY(7px) rotate(45deg); }
    .hamburger.is-open span:nth-child(2){ opacity:0; }
    .hamburger.is-open span:nth-child(3){ transform:translateY(-7px) rotate(-45deg); }

    /* Mobile polish ≤860px (same behavior as index) */
    @media (max-width: 860px){
      html, body { overflow-x: hidden; }
      header .container{ gap:10px; }
      .hamburger{ display:flex; }
      .nav{
        position:absolute; top:100%; right:22px; left:22px; background:#101012; border:1px solid var(--border);
        border-radius:12px; padding:10px; display:none; flex-direction:column; gap:8px; z-index:20; box-shadow:0 8px 24px rgba(0,0,0,.35);
      }
      .nav.is-open{ display:flex; }
      .btn{ width:100%; text-align:center; padding:12px 14px; font-size:16px; }


    }
                  /* Default: hide everywhere */
    .rotate-hint {
      display: none;
    }

    /* Show ONLY on small portrait touch screens */
    @media (max-width: 860px) and (orientation: portrait) and (hover: none) and (pointer: coarse) {
      .rotate-hint {
        display: block;
        text-align: center;
        font-size: 15px;
        color: #e5e7eb;
        margin: 10px auto;
        padding: 8px 14px;
        background: rgba(255, 255, 255, 0.05);
        border: 1px solid rgba(255, 255, 255, 0.08);
        border-radius: 10px;
        width: fit-content;
        font-style: italic;
        letter-spacing: 0.2px;
        backdrop-filter: blur(4px);
      }
    }
  </style>
</head>
<body>
  <header>
    <div class="container" style="display:flex;align-items:center;justify-content:space-between;position:relative;">
      <div class="brand">
        <div class="badge">TTC</div>
        <div>
          <div style="font-weight:700;font-size:20px;">TTC Delay Insights</div>
          <div class="muted" style="font-size:16px;">Data today, better commutes tomorrow.</div>
        </div>
      </div>

      <!-- Mobile hamburger (hidden on desktop via CSS) -->
      <button class="hamburger" id="menu-toggle" aria-label="Open menu" aria-expanded="false" aria-controls="site-nav">
        <span></span><span></span><span></span>
      </button>

      <div class="nav" id="site-nav">
        <a class="btn" href="index.html">Home</a>
        <a class="btn primary" href="overview.html" aria-current="page">Overview</a>
        <a class="btn" href="delayleaderboard.html">Delay Leaderboard</a>
        <a class="btn" href="ttcdelaydodge.html">Play TTC Delay Dodge</a>
        <a class="btn" href="about.html">About</a>
        <a class="btn" href="donate.html">Donate</a>
      </div>
    </div>
  </header>

  <main>
    <section class="aligned">

      <!-- Intro -->
      <div class="card">
        <div class="content intro">
          <h2>Overview: What the Data Says About TTC Delays (2018–2025)</h2>
          <p class="rotate-hint"><em>For the best experience, view on desktop or rotate your phone horizontally.</em></p>
          <p class="lead">An in-depth look at TTC subway delays through interactive plots. See where delays are worst, why they happen, and when they’re most disruptive, followed by recommendations and next steps.</p>
        </div>
      </div>

      <!-- Total Time Lost -->
      <div class="card">
        <div class="content">
          <div class="section-title">Total Time Lost to Delays</div>
          <div class="section-sub">Days Toronto loses each year across all lines and causes.</div>
          <iframe class="chartframe" src="data/plots/total_delay_by_year.html" title="Total time lost by year"></iframe>
        </div>
      </div>

      <!-- Line Trends -->
      <div class="card">
        <div class="content">
          <div class="section-title">Line Trends</div>
          <div class="section-sub">Time lost by line: Yonge–University (Line 1), Bloor–Danforth (Line 2), and Sheppard (Line 4).</div>
          <iframe class="chartframe" src="data/plots/line_delay_trends_by_year.html" title="Line delay trends by year"></iframe>
        </div>
      </div>

      <!-- Station Trends -->
      <div class="card">
        <div class="content">
          <div class="section-title">Which Stations Lose the Most Time?</div>
          <div class="section-sub">Bloor–Yonge, St George, Eglinton, and Kipling are consistently among the top contributors to time loss over the years.</div>
          <iframe class="chartframe" src="data/plots/station_delay_trends_by_year.html" title="Station delay trends by year"></iframe>
          <div class="tip">Tip: Visit the <em>Delay Leaderboard</em> to see which stations are leading time-loss this year. On the <em>Home</em> page, check out the <em>Toronto Subway: Delay Stats</em> interactive map to explore hotspots for Track Intrusion, Disorderly Patron, and Fire.</div>
        </div>
      </div>

      <!-- Top Reasons for Delays -->
      <div class="card">
        <div class="content">
          <div class="section-title">Top Reasons for Delays</div>
          <div class="section-sub">Patron-related incidents are the leading cause for time loss over the years, followed by mechanical/infrastructure issues.</div>
          <iframe class="chartframe" src="data/plots/delay_category_trend_by_year.html" title="Delay categories trend by year"></iframe>
        </div>
      </div>

      <!-- Patron and Mechanical Drivers -->
      <div class="card">
        <div class="content">
          <div class="section-title">Patron-Related Delays (Top driver for delays)</div>
          <div class="section-sub">Disorderly patrons, track intrusions, passenger illness and other human factors: a closer look at where patron-related incidents drive time loss.</div>
          <iframe class="chartframe" src="data/plots/patron_delay_trends_by_year.html" title="Patron-related delay trends"></iframe>
        </div>
      </div>

      <div class="card">
        <div class="content">
          <div class="section-title">Mechanical &amp; Infrastructure Delays (Top driver for delays)</div>
          <div class="section-sub">
            Signals, track switches, fire, and other technical causes: a closer look at where Mechanical &amp; Infrastructure-related incidents drive time loss.
            During the early rollout years, ATC-related delays increased as the system underwent testing and integration. After Line 1 became fully ATC-enabled in late 2022, reliability improved, with delays dropping between 2023 and 2025.
          </div>
          <iframe class="chartframe" src="data/plots/mechanical_infrastructure_delay_trends_by_year.html" title="Mechanical &amp; infrastructure delay trends"></iframe>
        </div>
      </div>

      <!-- Major vs Minor Delays -->
      <div class="card">
        <div class="content">
          <div class="section-title">Major Delays (≥ 20 minutes)</div>
          <div class="section-sub">An increasing trend of major delays lasting more than 20 minutes.</div>
          <iframe class="chartframe" src="data/plots/major_delay_trends_by_year.html" title="Major delay trends"></iframe>
        </div>
      </div>

      <div class="card">
        <div class="content">
          <div class="section-title">Minor Delays (&lt; 20 minutes)</div>
          <div class="section-sub">Minor delays lasting less than 20 minutes are also trending upward.</div>
          <iframe class="chartframe" src="data/plots/minor_delay_trends_by_year.html" title="Minor delay trends"></iframe>
        </div>
      </div>

      <!-- Delay Category Trend for Major Delays -->
      <div class="card">
        <div class="content">
          <div class="section-title">Top Categories Driving Major Delays</div>
          <div class="section-sub">A closer look at what causes most major (≥20 min) delays.</div>
          <iframe class="chartframe" src="data/plots/delay_category_trend_for_major_delays_by_year.html" title="Categories driving major delays"></iframe>
        </div>
      </div>

      <!-- Rush Hour, Weekday/Weekend, Seasonality -->
      <div class="card">
        <div class="content">
          <div class="section-title">Rush Hour Patterns</div>
          <div class="section-sub">More delays occur outside the morning peak period.</div>
          <iframe class="chartframe" src="data/plots/rush_hour_delay_trends_by_year.html" title="Rush hour delay trends"></iframe>
        </div>
      </div>

      <div class="card">
        <div class="content">
          <div class="section-title">Weekday vs Weekend Patterns</div>
          <div class="section-sub">The average minutes lost per service day are nearly identical on weekdays and weekends, showing that disruptions are consistent throughout the week.</div>
          <iframe class="chartframe" src="data/plots/weekday_weekend_delay_trends_by_year.html" title="Weekday vs weekend trends"></iframe>
        </div>
      </div>

      <div class="card">
        <div class="content">
          <div class="section-title">Seasonality</div>
          <div class="section-sub">Patterns are broadly similar across seasons.</div>
          <iframe class="chartframe" src="data/plots/season_delay_trends_by_year.html" title="Seasonality of delays"></iframe>
        </div>
      </div>

      <!-- Recommendations & Next Steps -->
      <div class="card">
        <div class="content">
          <div class="section-title" style="font-size:30px; margin-bottom:16px;">Recommendations &amp; Next Steps</div>
          <div class="section-sub" style="font-size:22px; margin-bottom:24px;">Based on the data, here’s where the TTC can focus next.</div>
          <ul style="margin:0 0 10px 18px; line-height:1.8; list-style-position:outside; font-size:20px;">
            <li style="margin-bottom:22px;">
              <strong>Expand Crisis-Response Coverage:</strong> Strengthen crisis-response teams within the downtown
              <strong>U-zone of Line&nbsp;1</strong>, with a recommended focus on <strong>Dundas, Bloor–Yonge, St&nbsp;George,</strong>
              and <strong>Queen</strong>. Extend coverage beyond the U-zone to include <strong>Warden, Sheppard–Yonge, Davisville,
              Eglinton, Lawrence,</strong> and <strong>Kipling</strong>, where patron-related incidents and track intrusions frequently cluster.
              On the <em>Home</em> page, explore the <em>Toronto Subway: Delay Stats</em> interactive map to view hotspots related to
              <strong>Track Intrusions</strong>, <strong>Disorderly Patrons</strong>, and <strong>Fires</strong>.
            </li>
            <li style="margin-bottom:22px;">
              <strong>Install Physical Safety Barriers:</strong> Introduce platform doors or interim safety barriers at
              high-risk track-intrusion stations — <strong>Queen, Dundas, Bloor–Yonge, Warden,</strong>
              and <strong>Sheppard–Yonge</strong> — and progressively expand these protections to other stations with recurring
              patron-related incidents.
            </li>
            <li style="margin-bottom:22px;">
              <strong>Investigate Fire-on-Track Hotspots:</strong> Review recurring <strong>fire-at-track-level incidents</strong>
              at <strong>Bloor–Yonge, Victoria Park, Islington,</strong> and <strong>Davisville</strong>. Assess underlying causes such
              as debris buildup or equipment faults and implement targeted maintenance or infrastructure upgrades to reduce recurrence.
            </li>
            <li style="margin-bottom:0;">
              <strong>Set Public Performance Targets:</strong> Establish and publicly report measurable goals for delay reduction,
              such as decreasing major delays (≥20&nbsp;minutes) by <strong>20%</strong> over three years or cutting
              <strong>track-intrusion incidents</strong> by <strong>25%</strong>. Regular reporting and transparency would strengthen
              accountability and demonstrate progress toward a more reliable transit system.
            </li>
          </ul>
        </div>
      </div>

    </section>
  </main>

  <footer>
    Toronto Open Data •
    <a href="https://ashaasvathaman.com">Asha Asvathaman</a>
  </footer>

  <!-- Mobile menu JS (same as index) -->
  <script>
    (function(){
      const btn = document.getElementById('menu-toggle');
      const nav = document.getElementById('site-nav');
      if(!btn || !nav) return;
      const closeMenu = () => {
        btn.classList.remove('is-open');
        nav.classList.remove('is-open');
        btn.setAttribute('aria-expanded','false');
      };
      btn.addEventListener('click', () => {
        const open = nav.classList.toggle('is-open');
        btn.classList.toggle('is-open', open);
        btn.setAttribute('aria-expanded', String(open));
      });
      nav.addEventListener('click', e => { if(e.target.closest('a')) closeMenu(); });
      window.addEventListener('resize', () => { if (window.innerWidth > 860) closeMenu(); });
    })();

    // On orientation change, prod each embedded plot to re-compute layout
    window.addEventListener("orientationchange", () => {
      // small delay lets the viewport settle
      setTimeout(() => {
        document.querySelectorAll("iframe.chartframe").forEach(f => {
          try {
            f.contentWindow.dispatchEvent(new Event("resize"));
            // direct Plotly resize if available (same-origin only)
            const plot = f.contentDocument && f.contentDocument.querySelector(".js-plotly-plot");
            if (plot && f.contentWindow.Plotly && f.contentWindow.Plotly.Plots?.resize) {
              f.contentWindow.Plotly.Plots.resize(plot);
            }
          } catch(e) { /* ignore cross-origin or not-ready errors */ }
        });

      }, 200);
    });
</script>
</body>
</html>
